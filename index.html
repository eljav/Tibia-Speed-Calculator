<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<!-- Bootstrap 5 -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">
	<style>
		@font-face {
			font-family: martel;
			src: url("font/martel.ttf");
		}
		body {
			background-color: #404040;
		}
		h3 {
			text-align:left;
		}
		.card {
			margin-bottom: 6px;
		}
		.card-body {
			background-color: #808080;
		}
		.radio {
			margin-top: 10px;
		}
		.btn {
            text-decoration: none;
            color: black;
            border: none;
            margin: 0px;
            padding: 0px;
        }
        .btn-link:hover,
		.btn-link:focus {
            text-decoration: none;
            border: none;
            outline: none !important;
            box-shadow: none;
        }
	</style>
	<title>Tibia Speed Calculator</title>
</head>
<body>
	<div class="container">
	<center>
		<h1 style="font-family: martel; color: orange; font-size: 80px;">Rodrijav Tibia Speed Calculator</h1>
	</center>
		<div class="row">
			<div class="col-4">
				<div class="card card-body" style="display: inline-block;">
					<h2 style="display: inline-block;">Character level</h2>
					<input type="number" style="width: 6rem; display: inline-block;" class="form-control mx-4" id="nivel" value="1" onChange="calcular();">
				</div>
			</div>
			<div class="col-4">
				<div class="card card-body" style="background-color: green; display:inline-block;">
					<h2 id="resultado" style="display:inline-block;">Speed</h2>
					<h2 id="breakpoint">Breakpoint</h2>
					<h5 id="above">Points above current breakpoint</h5>
					<h5 id="missing">Points missing until next breakpoint</h5>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-4">
				<div class="card card-body">
					<h2>Haste modifiers</h2>
					<div class="form-check" >
						<input class="form-check-input" type="radio" name="hasteModifier" value="1.0" onChange="calcular();" checked>
						Nothing 
					</div>
					<div class="form-check">
						<input class="form-check-input radio" style="" type="radio" name="hasteModifier" value="1.3" onChange="calcular();">
						<label class="form-check-label" for="flexRadioDefault2">
							<img src="images/spells and charms/Haste.webp"> Haste <i>Utani Hur</i>
						</label>
					</div>
					<div class="form-check" style="display:inline-block;">
						<input class="form-check-input radio" type="radio" name="hasteModifier" value="1.7" onChange="calcular();">
						<label class="form-check-label" for="flexRadioDefault2">
							<img src="images/spells and charms/Strong_Haste.webp"> Strong Haste <i>Utani Gran Hur</i>
						</label>
					</div>
					<div class="form-check">
						<input class="form-check-input radio" type="radio" name="hasteModifier" value="1.9" onChange="calcular();">
						<label class="form-check-label" for="flexRadioDefault2">
							<img src="images/spells and charms/Charge.webp"> Charge <i>Utani Tempo Hur</i>
						</label>
					</div>
					<div class="form-check">
						<input class="form-check-input radio" type="radio" name="hasteModifier" value="1.8" id="utamo-tempo-san" onChange="calcular();">
						<label class="form-check-label" for="flexRadioDefault2">
							<img src="images/spells and charms/Swift_Foot.webp"> Swift Foot <i>Utamo Tempo San</i>
						</label>
					</div>
					<div class="form-check">
						<input class="form-check-input radio" type="radio" name="hasteModifier" value="2.5" id="adrenaline-boost" onChange="calcular();">
						<label class="form-check-label" for="flexRadioDefault2">
							<img src="images/spells and charms/Adrenaline_Burst.webp"> Adrenaline Burst
						</label>
					</div>
				</div>
			</div>
			<div class="col-4">
				<div class="card card-body">
					<h2>Additional speed</h2>
					<div class="form-check form-switch">
						<input class="form-check-input speedAdicional" type="checkbox" value="10" onChange="calcular();">
						<label class="form-check-label" for="flexSwitchCheckChecked">
							Mount
						</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input speedAdicional" type="checkbox" value="30" onChange="calcular();">
						<label class="form-check-label" for="flexSwitchCheckChecked">
							Time Ring
						</label>
					</div>
					<div style="display: inline-block;">
							<h2 style="display: inline-block;">Food</h2> <i id="popoverData" class="far fa-question-circle" style="vertical-align: text-top;" data-bs-toggle="tooltip" data-bs-placement="right" title="Las comidas anulan los haste modifiers"></i>
						</div>
					<div class="form-check form-switch">
						<input class="form-check-input speedAdicional food" type="checkbox" name="foods" id="food1" value="80" onChange="clean('foods', 'food1'); calcular();">
						<label class="form-check-label" for="flexSwitchCheckChecked">
							Chili con Carniphilia
						</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input speedAdicional food" type="checkbox" name="foods" id="food2" value="50" onChange="clean('foods', 'food2'); calcular();">
						<label class="form-check-label" for="flexSwitchCheckChecked">
							Demonic Candy Ball
						</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input speedAdicional food" type="checkbox" name="foods" id="food3" value="100" onChange="clean('foods', 'food3'); calcular();">
						<label class="form-check-label" for="flexSwitchCheckChecked">
							Filled Jalapeno Peppers
						</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input speedAdicional food" type="checkbox" name="foods" id="food4" value="300" onChange="clean('foods', 'food4'); coconut(); calcular();" disabled>
						<label class="form-check-label" for="flexSwitchCheckChecked">
							Coconut Shrimp Bake
						</label> <i id="popoverData" class="far fa-question-circle" data-bs-toggle="tooltip" data-bs-placement="right" title="Only underwater. Must wear a Helmet of the Deep."></i>
					</div>
					<button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHelmets" aria-expanded="false" aria-controls="collapseHelmets">
						<h3>Helmets <img src="images/helmets/Crest_of_the_Deep_Seas.webp"></h3>
					</button>
					<div class="collapse" id="collapseHelmets">
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="helmets" id="helmet1" value="5" onChange="clean('helmets', 'helmet1'); helmet(); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Crest of the Deep Seas
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="helmets" id="helmet2" value="20" onChange="clean('helmets', 'helmet2'); helmet(); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Tiara of Power
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="helmets" id="helmet3" value="15" onChange="clean('helmets', 'helmet3'); helmet(); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Werewolf Helmet
							</label>
						</div>
					</div>
					<br/>
					<button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#collapseArmors" aria-expanded="false" aria-controls="collapseArmors">
						<h3>Armors <img src="images/armors/Elite_Draken_Mail.webp"></h3>
					</button>
					<div class="collapse" id="collapseArmors">
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="armors" id="armor1" value="10" onChange="clean('armors', 'armor1'); calcular();">
							<label class="form-check-label">
								Elite Draken Mail
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="armors" id="armor2" value="10" onChange="clean('armors', 'armor2'); calcular();">
							<label class="form-check-label">
								Swan Feather Cloak
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="armors" id="armor3" value="10" onChange="clean('armors', 'armor3'); calcular();">
							<label class="form-check-label">
								Zaoan Armor
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="armors" id="armor4" value="15" onChange="clean('armors', 'armor4'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Prismatic Armor
							</label>
						</div>
					</div>
					<br/>
					<button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#collapseLegs" aria-expanded="false" aria-controls="collapseLegs">
						<h3>Legs <img src="images/legs/Alloy_Legs.webp"></h3>
					</button>
					<div class="collapse" id="collapseLegs">
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="legs" id="legs1" value="10" onChange="clean('legs', 'legs1'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Alloy Legs
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="legs" id="legs2" value="10" onChange="clean('legs', 'legs2'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Grasshopper Legs
							</label>
						</div>
					</div>
					<br/>
					<button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBoots" aria-expanded="false" aria-controls="collapseBoots">
						<h3>Boots <img src="images/boots/Boots_of_Haste.webp"></h3>
					</button>
					<div class="collapse" id="collapseBoots">
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots1" value="10" onChange="clean('boots', 'boots1'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Badger Boots
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots2" value="20" onChange="clean('boots', 'boots2'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Boots of Haste
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots3" value="10" onChange="clean('boots', 'boots3'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Cobra Boots
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots4" value="15" onChange="clean('boots', 'boots4'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Draken Boots
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots5" value="15" onChange="clean('boots', 'boots5'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Oriental Shoes
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots6" value="20" onChange="clean('boots', 'boots6'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Pair of Soulstalkers
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots7" value="15" onChange="clean('boots', 'boots7'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Pair of Soulwalkers
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots8" value="15" onChange="clean('boots', 'boots8'); calcular(); ">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Prismatic Boots
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots9" value="30" onChange="clean('boots', 'boots9'); calcular(); ">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Void Boots
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots10" value="15" onChange="clean('boots', 'boots10'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Winged Boots
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots11" value="5" onChange="clean('boots', 'boots11'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Zaoan Shoes
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots12" value="-5" onChange="clean('boots', 'boots12'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Depth Calcei
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="boots" id="boots13" value="-6" onChange="clean('boots', 'boots13'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Fur Boots
							</label>
						</div>
					</div>
					<button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNecklaces" aria-expanded="false" aria-controls="collapseNecklaces">
						<h3>Necklaces <img src="images/amulets and necklaces/Shrunken_Head_Necklace.webp"></h3>
					</button>
					<div class="collapse" id="collapseNecklaces">
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="necklaces" id="necklace1" value="2" onChange="clean('necklaces', 'necklace1'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Beetle Necklace
							</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="necklaces" id="necklace2" value="2" onChange="clean('necklaces', 'necklace2'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Shrunken  Head Necklace
							</label>
						</div>
					</div>
					<button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#collapseShields" aria-expanded="false" aria-controls="collapseShields">
						<h3>Shields <img src="images/shields/Sparking_Rainbow_Shield.webp"></h3>
					</button>
					<div class="collapse" id="collapseShields">
						<div class="form-check form-switch">
							<input class="form-check-input speedAdicional" type="checkbox" name="shields" id="shield1" value="10" onChange="clean('shields', 'shield1'); calcular();">
							<label class="form-check-label" for="flexSwitchCheckChecked">
								Sparking Rainbow Shield
							</label>
						</div>
					</div>
				</div>
			</div>
			<div class="col-4">
				<div class="card card-body">
					<h2>Terrain</h2>
					<select class="form-select" id="tile" aria-label="Default select example" style="width: 12rem; display:inline-block;" onChange="terreno(); calcular();">
						<option value="0">Omruc Maze</option>
						<option value="1">Bridges</option>
						<option value="2">Oramond Sewer Bridges</option>
						<option value="3" selected>Town, Depots, etc.</option>
						<option value="4">Roshamuul Surface</option>
						<option value="5">Darashia Town</option>
						<option value="6">Red Planks</option>
						<option value="7">Hive Structures</option>
						<option value="8">Dirt Floor</option>
						<option value="9">Dark Grass</option>
						<option value="10">Mountain Floor, Deeplings</option>
						<option value="11">Desert Sand, Snow, etc.</option>
						<option value="12">Swimming</option>
						<option value="13">Dirt, Lava</option>
						<option value="14">Shallow Water, Slime, etc.</option>
						<option value="15">Underwater</option>
					</select>
				</div>
			</div>
		</div>
		<div class="row">
			<img src="images/table.jpg">
		</div>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous">
	</script>
	<script>
		var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
		var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
		  return new bootstrap.Tooltip(tooltipTriggerEl)
		})
	</script>

	<script>
		function calcular() {
			var nivel = document.getElementById("nivel").value;
			var modificadorHaste = 1.0;
			const rbs = document.getElementsByName("hasteModifier");
			for (const rb of rbs) {
				if (rb.checked) {
					modificadorHaste = parseFloat(rb.value);
					break;
				}
			}
			var speedAdicional = 0;
			const speeds = document.getElementsByClassName("speedAdicional");
			for (const speed of speeds) {
				if (speed.checked) {
					speedAdicional += parseInt(speed.value);
					if (speed.classList.contains("food")) {
						modificadorHaste = 1.0
					}
				}
			}
			var resultadoSpeed = (69 + parseInt(nivel)) * parseFloat(modificadorHaste) + 40 + parseInt(speedAdicional);
			resultadoSpeed = resultadoSpeed.toFixed();
			var nextBreakpoint = 0;
			var breakpoint;
			// var friction = [70];
			//var breakpointsSpeeds = {
			var	tiles = [
				[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 111, 142, 200, 342, 1070], // Omruc Maze
				[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 120, 147, 192, 278, 499, 1842], // Bridges
				[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 127, 157, 205, 299, 543, 2096], // Oramond Sewer Bridges
				[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 113, 135, 167, 219, 321, 592, 2382], // Town, Depots, etc.
				[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 126, 150, 187, 248, 367, 696, 3060], // Roshamuul Surface
				[0, 0, 0, 0, 0, 0, 0, 0, 0, 120, 139, 167, 208, 278, 417, 813, 3913], // Darashia Town
				[0, 0, 0, 0, 0, 0, 0, 0, 0, 121, 140, 168, 211, 281, 423, 826, 4012], // Red Planks
				[0, 0, 0, 0, 0, 0, 0, 0, 0, 125, 146, 175, 219, 293, 444, 876, 4419], // Hive Structures
				[0, 0, 0, 0, 0, 0, 0, 0, 115, 131, 153, 183, 230, 310, 472, 944, 4992], // Dirt Floor (Caves)
				[0, 0, 0, 0, 0, 0, 0, 111, 125, 143, 167, 201, 254, 344, 531, 1092, 6341], // Dark Grass
				[0, 0, 0, 0, 0, 0, 0, 120, 135, 155, 181, 219, 278, 380, 595, 1258, 8036], // Mountain Floor, Deeplings
				[0, 0, 0, 0, 0, 0, 116, 129, 145, 167, 196, 238, 304, 419, 663, 1443, 10167], // Desert Sand, Snow, etc.
				[0, 0, 0, 0, 0, 112, 124, 138, 156, 179, 212, 258, 331, 459, 737, 1652, 12846], // Walkable Water (Swimming)
				[0, 0, 0, 0, 0, 120, 132, 148, 167, 192, 227, 279, 359, 502, 818, 1886, 16212], // Dirt (Below Wheat), Lava
				[0, 0, 0, 114, 124, 135, 149, 167, 190, 219, 261, 322, 419, 597, 998, 2444, 25761], // Shallow Water, Slime, etc.
				[117, 126, 135, 146, 160, 175, 195, 220, 252, 295, 356, 446, 598, 884, 1591, 4557, 81351] // Underwater
			];
			var tile = document.getElementById("tile").value;
			var tileActivo = tiles[tile];
			for (i = 0; i < tileActivo.length ; i++ ) {
				if (resultadoSpeed < tileActivo[i]) {
					breakpoint = i;
			 		nextBreakpoint = tileActivo[i];
			 		lastBreakpoint = tileActivo[i-1];
			 		break;
				}
			}
			
			var above = resultadoSpeed - lastBreakpoint;
			var missingSpeed = nextBreakpoint - resultadoSpeed;
			console.log(above);
			if (Number.isNaN(above)) {
				above = 0;
			}
			document.getElementById("resultado").innerHTML = "Speed: " + resultadoSpeed;
			//document.getElementById("nextBreakpoint").innerHTML =  "Next breakpoint: " + nextBreakpoint;
			document.getElementById("above").innerHTML = "Points above current breakpoint: " + above;
			document.getElementById("missing").innerHTML = "Points missing for next breakpoint: " + missingSpeed;
			document.getElementById("breakpoint").innerHTML = "Breakpoint: " + breakpoint;
		}

		function clean(type, selected) {
			const toCleans = document.getElementsByName(type);
			for (const toClean of toCleans) {
				if (toClean.id != selected) {
					toClean.checked = false;
				}
			}
		}

		function coconut() {
			const coco = document.getElementById("food4");
			const toCleans = document.getElementsByName("helmets");
			if (coco.checked) {
				for (const toClean of toCleans) {
					toClean.checked = false;
				}
			}
		}

		function helmet() {
			const coco = document.getElementById("food4");
			const helmets = document.getElementsByName("helmets");
			for (const helmet of helmets) {
				if (helmet.checked) {
					coco.checked = false;
				}
			}
		}

		function terreno() {
			const terreno = document.getElementById("tile");
			const coco = document.getElementById("food4");
			if (terreno.value == 15) {
				coco.disabled = false;
			}
			else {
				coco.checked = false;
				coco.disabled = true;
			}
		}

		window.onload = function() {
			calcular();
		}
	</script>
</body>
</html>